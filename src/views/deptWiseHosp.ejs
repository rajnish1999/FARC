<%- include('partials/header') %>  
<script src="https://code.jquery.com/jquery-3.5.1.js" integrity="sha256-QWo7LDvxbWT2tbbQ97B53yJnYU3WhH/C8ycbRAkjPDc=" crossorigin="anonymous"></script>
<script>
    let arr = [`"Health is an investment, not an expense."`, `"Real heroes wear masks below their eyes."`, `"Stay as safe as you can! And thank you!"`];
    let a = 0;  
    setInterval(() => {   
        const moving = document.getElementById('changingContent');  
        moving.innerHTML=arr[a];    
        a++;
        a = a % arr.length;    
    }, 3000);  

</script>

<div class="jumbotron wide img_jumbo changingDiv" style="background-image: url('../images/page2.1.jpg');">
    <div class="container text-center">
        <h3 class="display-4" id="changingContent">Faster Appointment, Rapid Cure</h3>
    </div>
</div>


<div class="jumbotron transparent no_margin" style="padding: 2rem;">
    <div class="center">         
        <u><h3>Tests</h3> </u>
    </div>
</div>

<div class="container" style="box-shadow: 10px 10px 5px grey; padding: 0px;">
    <table >
        <tr>
            <th>Tests</th>
            <th>Price</th>
        </tr>        
        <% for(let i=0;i < department.treatments.length; i++) {%>
            <tr>
                <td><%= department.treatments[i].treatmentName %></td>
                <td><%= department.treatments[i].treatmentPrice %></td>
            </tr>
        <% } %>        
    </table>
</div>

<div class="jumbotron transparent no_margin" style="padding: 2rem; margin-top: 40px;">
    <div class="center">
        <u><h3>Hospitals</h3> </u>
    </div>
</div>

<a href="javascript:demoFromHTML()" class="button">Run Code</a>
    <div id="content" style.color ="red">
        <h1>  
            We support special element handlers. Register them with jQuery-style.
        </h1>
</div>

<% const hospList = [] %>

<% for(let i=0;i < hospitals.length;i++){ %>
   
    <% if(hospitals[i].depts.includes(deptId)){ %>
        <% hospList.push(hospitals[i]) %>
    <% }else{ %>
        <% console.log('no deptid found') %> 
    <% } %> 
<% } %>

<% if(hospList.length > 0){ %> 


    <!-- <% for(let i=0;i < hospList.length;i++){ %>
        <p><%= hospList[i].hName %></p>
    
    <% } %> -->


    <% const l  = Math.ceil(hospList.length/3) %>
    <% let k = 0 %>
    <% for(let i =0;i < l ;i++){ %>
        <div class="row">
            <% for(let j = k;j < (k+3) ;j++){ %>
                <% if(j < hospList.length) {%>
                    <div class="column">
                        <div class="card " style="transition: 0.5s;">
                            <img src="../images/hospital_icon.jpg" alt="hospital_image" class="card-img-top">
                            <!-- <p> <%= hospList[j].hName%> </p>  -->
                            <div class="card-body">
                                <p class="card-title"> <%= hospList[j].hName%> </p>
                            </div>
                            <button onclick="location.href='/specificHospital/<%= hospList[j].hId%>'" 
                                type="button"
                                class="btn btn-success" 
                                style="margin-bottom: 15px;"
                                style="margin-bottom: 15px"
                                class="deptButton"
                            >
                                Visit Hospital
                            </button>
                            
                        </div>
                    </div>
                <% } %>
            <% } %>
            <% k=k+3 %>   
        </div>
    <% } %>
    


<% }else{ %> 
    <p>No match found</p>
<% } %> 

<style>

.card {
    margin: 0 auto; /* Added */
    float: none; /* Added */
    margin-bottom: 10px; /* Added */
}

table {
  font-family: arial, sans-serif;
  border-collapse: collapse;
  width: 100%;
}

td, th {
  border: 1px solid #dddddd;
  text-align: left;
  padding: 8px;
}

tr:nth-child(even) {
  background-color: #7cb8b8;
  color: white;
}

</style>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/1.3.2/jspdf.min.js"></script>
    <script>
        function demoFromHTML() {
            var pdf = new jsPDF('p', 'pt', 'letter');
            // source can be HTML-formatted string, or a reference
            // to an actual DOM element from which the text will be scraped.
            source = $('#content')[0];
    
            // we support special element handlers. Register them with jQuery-style 
            // ID selector for either ID or node name. ("#iAmID", "div", "span" etc.)
            // There is no support for any other type of selectors 
            // (class, of compound) at this time.
            specialElementHandlers = {
                // element with id of "bypass" - jQuery style selector
                '#bypassme': function (element, renderer) {
                    // true = "handled elsewhere, bypass text extraction"
                    return true
                }
            };
            margins = {
                top: 80,
                bottom: 60,
                left: 40,
                width: 522
            };
            // all coords and widths are in jsPDF instance's declared units
            // 'inches' in this case
            pdf.fromHTML(
                source, // HTML string or DOM elem ref.
                margins.left, // x coord
                margins.top, { // y coord
                    'width': margins.width, // max width of content on PDF
                    'elementHandlers': specialElementHandlers
                },
    
                function (dispose) {
                    // dispose: object with X, Y of the last line add to the PDF 
                    //          this allow the insertion of new lines after html
                    pdf.save('Test.pdf');
                }, margins
            );
        }
    </script>
<%- include('partials/footer') %>
